{% extends "template_base.html" %}
{% load static %}
{% block extra_head %}
    <link rel="stylesheet" href="{% static 'css/lista_instituciones.css' %}">
{% endblock %}
{% block title %} Lista de Instituciones {% endblock %}


{% block content %}
   
    
    <section class="SeccionIfts">
       
        <div class="textoSeccion">
           <h2>
               Encontrá la información que necesitas filtrando en base al IFTS
           </h2>
       </div>
       <div class="iftsYopiniones"> 
           <div class="ifts">
            <h1>Lista de Instituciones</h1>
                {% for institucion in instituciones %}
        
                    <ul class="ulIfts">
                        <li><a href="{{institucion.url}}">{{ institucion.nombre }}</a>
        
                            <div class="tarjetaIfts">
                                <div class="imgTarjetaIfts">
                                    <img src="{{ institucion.img_perfil.url }}" alt="">
                                </div>
                                <div class="divBotonesTarjeta">
                                    <a href="{% url 'lista_carreras' %}"><button id="btnIftsCarreras">Carreras</button></a>
                                    <a href="{% url 'lista_materias' %}"><button id="btnIftsMaterias">Materias</button></a>
                                    <a href="{% url 'lista_profesores' %}"><button id="btnIftsProfesores">Profesores</button></a>
                                    <a href="{% url 'opiniones_por_entidad' model_name='institucion' entity_id=institucion.id %}"><button id="btnIftsOpiniones">Opiniones</button></a>
                                    <div>Puntaje</div>
                                </div>
                            </div>
                        </li>
                    </ul>
                {% endfor %}
            </div>
            <div class="seccionOpiniones">

            </div>
        </div>
      
    </section>

                                                                    <!-- NO FUNCIONA TODAVIA EL SCRIPT -->
    <div class="container">
        <!-- Aquí se cargarán las nuevas tarjetas de instituciones -->
    </div>

    <script>
        window.addEventListener('scroll', function() {
            // Verifica si el usuario ha llegado al final de la ventana
            if ((window.innerHeight + window.scrollY) >= document.body.offsetHeight) {
                cargarMasDatos();
            }
        });
        
        let cargando = false;
        let paginaActual = 1;
        const totalPaginas = 5; // Replace '5' with the actual value of the total number of pages
        
        function cargarMasDatos() {
            if (cargando || paginaActual >= totalPaginas) return;
            cargando = true;
            paginaActual++;
        
            fetch(`?page=${paginaActual}`)
                .then(response => response.json())
                .then(data => {
                    const container = document.querySelector('.container');
                    container.innerHTML += data.html; // Asume que la respuesta incluye HTML de las nuevas tarjetas
                    cargando = false;
                })
                .catch(error => {
                    console.error('Error al cargar más datos:', error);
                    cargando = false;
                });
        }
    </script>
        
{% endblock %}


